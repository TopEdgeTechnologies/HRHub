
@{
	ViewData["Title"] = "Forget Password";
	Layout = null;
}

<html lang="en" dir="ltr">
<head>

	<!-- Meta data -->
	<meta charset="UTF-8">
	<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=0'>
	<meta content="DayOne - It is one of the Major Dashboard Template which includes - HR, Employee and Job Dashboard. This template has multipurpose HTML template and also deals with Task, Project, Client and Support System Dashboard." name="description">
	<meta content="Spruko Technologies Private Limited" name="author">
	<meta name="keywords" content="admin dashboard, admin panel template, html admin template, dashboard html template, bootstrap 5 dashboard, template admin bootstrap 5 , simple admin panel template, simple dashboard html template,  bootstrap admin panel, task dashboard, job dashboard, bootstrap admin panel, dashboards html, panel in html, bootstrap 5 dashboard, bootstrap 5 dashboard, bootstrap5 dashboard" />

	<!-- Title -->
	<title>Dayone - Multipurpose Admin & Dashboard Template</title>

	<!--Favicon -->
	<link rel="icon" href="~/assets/images/brand/favicon.ico" type="image/x-icon" />

	<!-- Bootstrap css -->
	<link href="~/assets/plugins/bootstrap/css/bootstrap.css" rel="stylesheet" id="style" />

	<!-- Style css -->
	<link href="~/assets/css/style.css" rel="stylesheet" />
	<link href="~/assets/css/plugins.css" rel="stylesheet" />

	<!-- Animate css -->
	<link href="~/assets/css/animated.css" rel="stylesheet" />

	<!---Icons css-->
	<link href="~/assets/css/icons.css" rel="stylesheet" />

</head>

<body class="login-img">


		<style >
		#captcha-container {
			font-size: 24px;
			font-weight: bold;
			margin-bottom: 10px;
		}
	</style>


	<div class="page responsive-log login-bg">
		<div class="page-single">
			<div class="container">
				<div class="row">
					<div class="col mx-auto">
						<div class="row justify-content-center">
							<div class="col-md-8 col-lg-6 col-xl-4 col-xxl-4">
								<div class="card my-5">
									<div class="p-4 pt-6 text-center">
										<h1 class="mb-2">Forgot Password</h1>
										<p class="text-muted">Enter the email address registered on your account</p>
										<div id="AlertValidationSentEmail" style="display:none">

											<div class="alert alert-success" role="alert">
												<strong>Success! </strong> <span id="ValidationTextSucess"></span>
												<a href="javascript:void(0);" class="alert-link"></a>
											</div>


										</div>

										<div id="AlertValidationAccount"  style="display:none">

											<div  class="alert alert-warning" role="alert">
												<strong>Warning! </strong> <span id="ValidationText"></span>
												<a href="javascript:void(0);" class="alert-link"></a>
											</div>


										</div>
										
										<div id="AlertValidationCaptcha" style="display:none">
											<div   class="alert alert-warning" role="alert">
											<strong>Warning! </strong> Invalid CAPTCHA. Please try again.
											<a href="javascript:void(0);" class="alert-link"></a>
										</div>

										</div>
										
									</div>

									
									
									<form asp-action="ForgetPassword" asp-controller="ResetPassword" class="card-body pt-3" id="myform">
										<div class="form-group">
											<label class="form-label">E-Mail</label>
											<div class="input-group mb-4">
												<div class="input-group">
													<a class="input-group-text">
														<i class="fe fe-mail"></i>
													</a>
													<input class="form-control" id="Email" name="Email" placeholder="Enter Email">
													@*<input class="form-control" asp-for="IPAddress" type="text">*@
												</div>
											</div>
										</div>
										<div id="captcha-container"></div>
										<div class="form-group">
											<div class="input-group mb-4">
												<div class="input-group">
													<a class="input-group-text">
														<i class="fa fa-refresh"></i>
													</a>
													<input class="form-control" id="captcha-input" name="captcha-input" placeholder="Enter Captcha">

												</div>
											</div>
										</div>


										<div class="submit">
											
											
											<button class="btn btn-primary btn-block" type="button"  id="BtnSend">Send</button>
												
											
										</div>
										<div class="text-center mt-4">
											<p class="text-dark mb-0">Remembered your password?<a class="text-primary ms-1" href="@Url.Action("Loginpage", "User")">Login</a></p>
										</div>
										<div class="text-center mt-4">
											
											<p class="text-dark mb-0" id="ShowMSG"></p>
												
											
										</div>
									</form>
									
									<div class="card-body border-top-0 pb-6 pt-2">
										<div class="text-center">
											<span class="avatar brround me-3 bg-primary-transparent text-primary"><i class="ri-facebook-line"></i></span>
											<span class="avatar brround me-3 bg-primary-transparent text-primary"><i class="ri-instagram-line"></i></span>
											<span class="avatar brround me-3 bg-primary-transparent text-primary"><i class="ri-twitter-line"></i></span>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Jquery js-->
	<script src="~/assets/plugins/jquery/jquery.min.js"></script>

	<!-- Bootstrap js-->
	<script src="~/assets/plugins/bootstrap/js/popper.min.js"></script>
	<script src="~/assets/plugins/bootstrap/js/bootstrap.min.js"></script>


	<!-- P-scroll js-->
	<script src="~/assets/plugins/p-scrollbar/p-scrollbar.js"></script>

	<!--Sticky js -->
	<script src="~/assets/js/sticky.js"></script>


	<!-- Color Theme js -->
	<script src="~/assets/js/themeColors.js"></script>

	<!-- custom js -->
	<script src="~/assets/js/custom.js"></script>

	<script src="~/assets/plugins/notify/js/rainbow.js"></script>
	<script src="~/assets/plugins/notify/js/sample.js"></script>
	<script src="~/assets/plugins/notify/js/jquery.growl.js"></script>
	<script src="~/assets/plugins/notify/js/notifIt.js"></script>
	<script src="~/assets/js/popover.js"></script>




	<script>


	

		function ForgetPassword() {
			$("#AlertValidationAccount").hide();

			var status = true;
			
			if ($("#Email").val().trim() == "") {

		 $("#ValidationText").text("Please Enter Email");
			$("#AlertValidationAccount").show();

				//$.growl.warning({
				//	message: "Please Enter Email"
				//});
				$("#Email").css("border-color", "red");
				status = false;
				return false;

			}
			else {
				
				$("#Email").css("border-color", "#ddd");
			}

			// UPdate Status
			var Data = { Email: $("#Email").val() == '' ? '""' : $("#Email").val() }
			
			$.ajax({
				async: false,
				url: "/ResetPassword/CheckEmail",
				type: "GET",
				data: Data,
				success: function (data) {
					if (data != "") {
						
						if (data.success==false) {
							


							$("#ValidationText").text(data.message);
							$("#AlertValidationAccount").show();

							$('#captcha-input').val('');
							
							status = false;
						}
						
					}
				},
				error: function () {
					status = false;

				}
			})

			if (status) {
				var ObjData = { Email: $("#Email").val() };
				$.ajax({
					async: false,
					url: "/ResetPassword/ForgetPassword",
					type: "POST",
					data: ObjData,
					success: function (data) {
						if (data != "") {
							debugger
							if (data.success == true) {

								$('#ValidationTextSucess').text(data.message);
								$('#AlertValidationSentEmail').show();

								$('#BtnSend').text('Re-Send');
								
								notif({
								msg: `<i class='fa fa-check fs-20 me-2'></i><b>Success:</b> ${data.message}`,
								type: "success"
							});

								$('#captcha-input').val('');
								
							}

						}
					},
					error: function () {
						$.growl.warning({
							message: "Something Went Wrong "
						});


					}
				})
			
			}



		}



		$("#BtnSend").click(function () {

			$("#AlertValidationSentEmail").hide();
			$("#AlertValidationAccount").hide();

			$("#AlertValidationCaptcha").hide();


			if ($("#Email").val().trim() == "") {
				
				$("#Email").css("border-color", "red");
				$("#ValidationText").text("Please Enter Email");
				$("#AlertValidationAccount").show();
				
				return false;

			}
			else {
				
				$("#Email").css("border-color", "#ddd");
			}

			if ($("#captcha-input").val().trim() == "") {
				
						
				$("#captcha-input").css("border-color", "red");
				$("#ValidationText").text("Please enter CAPTCHA");
				
				$("#AlertValidationAccount").show();

				return false;

			}
			else {
				
				$("#captcha-input").css("border-color", "#ddd");
			}


			var enteredCaptcha = $('#captcha-input').val();
			var captcha = $('#captcha-container').text();

			if (enteredCaptcha === captcha) {
				
				ForgetPassword();
			} else {
				// CAPTCHA is incorrect


				$("#AlertValidationCaptcha").show();
				
				generateCaptcha();
			}
		});

		


  // Generate a random CAPTCHA
  function generateCaptcha() {
    var captcha = Math.random().toString(36).slice(2, 8);
    $('#captcha-container').text(captcha);
  }

  // Generate initial CAPTCHA on page load
  $(document).ready(function() {

			//$(".alert").delay(5000).slideUp(200, function () {
			//	$(this).alert('close');
			//});
			$('#captcha-container').on('copy paste', function (e) {
				e.preventDefault();
				return false;
			});
	  generateCaptcha();
  });

  


	
	</script>









</body>
</html>